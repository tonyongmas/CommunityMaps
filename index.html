<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏® ‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡∏ï‡∏≥‡∏ö‡∏•‡∏ï‡∏±‡∏ô‡∏´‡∏¢‡∏á‡∏°‡∏±‡∏™</title>
  
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.js"></script>

  <style>
    /* ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡∏ü‡∏≠‡∏ô‡∏ï‡πå */
    body { 
      margin: 0; 
      padding: 0; 
      font-family: 'Prompt', sans-serif; 
      display: flex; 
      flex-direction: column; 
      height: 100vh;
      background-color: #f4f6f9;
    }

    /* ‡πÅ‡∏ñ‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô (Navbar) */
    .navbar {
      background-color: #1A5276; /* ‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Ç‡πâ‡∏° */
      color: white;
      padding: 10px 24px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      z-index: 1000;
    }

    /* ‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡πÅ‡∏•‡∏∞‡∏ä‡∏∑‡πà‡∏≠ */
    .navbar-title {
      display: flex;
      align-items: center;
      gap: 15px; /* ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° */
    }

    .nav-logo {
      height: 60px; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡πÇ‡∏•‡πÇ‡∏Å‡πâ */
      width: auto;
      filter: drop-shadow(0px 2px 4px rgba(0,0,0,0.3)); /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏≤‡πÉ‡∏´‡πâ‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏î‡∏π‡∏°‡∏µ‡∏°‡∏¥‡∏ï‡∏¥ */
    }

    .title-text {
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .title-text h1 {
      margin: 0;
      font-size: 1.8rem; /* ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏î‡πà‡∏ô‡∏ä‡∏±‡∏î */
      font-weight: 600;
      letter-spacing: 0.5px;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.3); /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏≤‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏•‡∏≠‡∏¢‡πÄ‡∏î‡πà‡∏ô */
    }

    .title-text span {
      font-size: 1.1rem; /* ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏• */
      color: #D6EAF8; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏µ‡πÉ‡∏´‡πâ‡∏™‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô */
      margin-top: 2px;
      font-weight: 400;
    }

    /* ‡∏õ‡∏∏‡πà‡∏° Admin */
    .btn-admin {
      background-color: #F39C12;
      color: white;
      border: none;
      padding: 10px 18px;
      font-family: 'Prompt', sans-serif;
      font-size: 1rem;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 500;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }

    .btn-admin:hover {
      background-color: #D68910;
      transform: translateY(-2px);
      box-shadow: 0 4px 6px rgba(0,0,0,0.3);
    }

    .btn-admin.active {
      background-color: #27AE60;
    }

    /* ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà */
    #map { 
      flex-grow: 1; 
      width: 100%; 
      z-index: 1;
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î Navbar ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
    @media (max-width: 600px) {
      .navbar { padding: 10px 15px; flex-direction: column; gap: 10px; }
      .title-text h1 { font-size: 1.4rem; }
      .title-text span { font-size: 0.9rem; }
      .nav-logo { height: 50px; }
    }
  </style>
</head>
<body>

  <div class="navbar">
    <div class="navbar-title">
      <img src="https://img2.pic.in.th/pic/71f81565dc59a7f9545542493a5514ab.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡∏ï‡∏≥‡∏ö‡∏•‡∏ï‡∏±‡∏ô‡∏´‡∏¢‡∏á‡∏°‡∏±‡∏™" class="nav-logo">
      <div class="title-text">
        <h1>‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏ä‡∏∏‡∏°‡∏ä‡∏ô ‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡∏ï‡∏≥‡∏ö‡∏•‡∏ï‡∏±‡∏ô‡∏´‡∏¢‡∏á‡∏°‡∏±‡∏™</h1>
      </div>
    </div>
    <button id="adminBtn" class="btn-admin">
      üîí ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô
    </button>
  </div>

  <div id="map"></div>

  <script>
    const MAP_CENTER = [6.29445, 101.72362];
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzN3IxvSwJEd2Zz3zhf53R0130SCEMPm4IEmhJPRy0rmgX-QsagZMhHTP7VTUyHi0u_/exec'; // ‚ö†Ô∏è ‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡πÉ‡∏™‡πà URL ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
    const ADMIN_PASSWORD = "1234"; 

    const map = L.map('map').setView(MAP_CENTER, 16);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '¬© OpenStreetMap'
    }).addTo(map);

    const layerGroups = {}; 
    
    // üåü ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
    let highlightHalo = null; // ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏•‡πÄ‡∏¢‡∏≠‡∏£‡πå "‡∏Ç‡∏≠‡∏ö‡∏Ç‡∏≤‡∏ß" ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏ã‡πâ‡∏≠‡∏ô
    let selectedLayer = null; // ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏•‡πÄ‡∏¢‡∏≠‡∏£‡πå "‡πÄ‡∏™‡πâ‡∏ô‡∏™‡∏µ‡πÄ‡∏î‡∏¥‡∏°" ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏•‡∏¥‡∏Å

    // üåü ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
    function resetHighlight() {
      if (highlightHalo) {
        map.removeLayer(highlightHalo); // ‡∏•‡∏ö‡∏Ç‡∏≠‡∏ö‡∏Ç‡∏≤‡∏ß‡∏ó‡∏¥‡πâ‡∏á
        highlightHalo = null;
      }
      if (selectedLayer) {
        selectedLayer.setStyle(selectedLayer.defaultStyle); // ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™‡πÄ‡∏î‡∏¥‡∏°
        selectedLayer = null;
      }
    }

    // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏û‡∏∑‡πâ‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á‡πÜ ‡πÉ‡∏´‡πâ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
    map.on('click', resetHighlight);

    fetch(SCRIPT_URL)
      .then(response => response.json())
      .then(data => {
        data.forEach(item => {
          try {
            const latlngs = JSON.parse(item.coords);
            let mapLayer;
            let defaultStyle = {}; 

            if (item.type === 'marker') {
              let markerOptions = {};
              if (item.icon && item.icon.trim() !== "") {
                markerOptions.icon = L.icon({
                  iconUrl: item.icon, iconSize: [32, 32], iconAnchor: [16, 32], popupAnchor: [0, -32]
                });
              }
              mapLayer = L.marker(latlngs, markerOptions);
              
              mapLayer.on('click', function(e) {
                resetHighlight(); 
                map.flyTo(e.latlng, 17, { duration: 1.5 }); 
              });

            } else {
              if (item.type === 'boundary') {
                defaultStyle = { color: item.color || '#FF0000', weight: 4, dashArray: '10, 10', fillOpacity: 0 };
                mapLayer = L.polygon(latlngs, defaultStyle);
              } else if (item.type === 'polyline') {
                defaultStyle = { color: item.color, weight: 5, opacity: 0.9 };
                mapLayer = L.polyline(latlngs, defaultStyle);
              } else {
                defaultStyle = { color: item.color, fillColor: item.color, fillOpacity: 0.4, weight: 2 };
                mapLayer = L.polygon(latlngs, defaultStyle);
              }

              // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ
              mapLayer.defaultStyle = defaultStyle;

              // üåü ‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏™‡πâ‡∏ô ‡∏´‡∏£‡∏∑‡∏≠ ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà
              mapLayer.on('click', function(e) {
                L.DomEvent.stopPropagation(e); 
                resetHighlight(); // ‡∏•‡πâ‡∏≤‡∏á‡∏≠‡∏±‡∏ô‡πÄ‡∏Å‡πà‡∏≤‡∏≠‡∏≠‡∏Å‡∏Å‡πà‡∏≠‡∏ô

                selectedLayer = e.target;
                const isPolygon = selectedLayer instanceof L.Polygon; // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏™‡πâ‡∏ô‡∏ñ‡∏ô‡∏ô
                const currentWeight = selectedLayer.defaultStyle.weight || 2;

                // 1. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö "‡∏Ç‡∏≠‡∏ö‡∏Ç‡∏≤‡∏ß"
                const haloStyle = {
                  color: '#FFFFFF',          // ‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß
                  weight: currentWeight + 6, // ‡∏ö‡∏ß‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏î‡∏¥‡∏° ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏•‡πâ‡∏ô‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏ö
                  opacity: 1,
                  fill: false,               // ‡πÑ‡∏°‡πà‡πÄ‡∏ï‡∏¥‡∏°‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á
                  dashArray: ''              // ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏Ç‡∏≠‡∏ö‡∏Ç‡∏≤‡∏ß‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏∂‡∏ö‡πÄ‡∏™‡∏°‡∏≠
                };

                // 2. ‡∏ß‡∏≤‡∏î‡∏Ç‡∏≠‡∏ö‡∏Ç‡∏≤‡∏ß‡∏•‡∏á‡πÑ‡∏õ‡∏ö‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà
                if (isPolygon) {
                  highlightHalo = L.polygon(selectedLayer.getLatLngs(), haloStyle).addTo(map);
                } else {
                  highlightHalo = L.polyline(selectedLayer.getLatLngs(), haloStyle).addTo(map);
                }

                // 3. ‡∏à‡∏±‡∏î‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô (Z-Index) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏™‡πâ‡∏ô‡∏™‡∏µ‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏±‡∏ö‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô‡∏Ç‡∏≠‡∏ö‡∏Ç‡∏≤‡∏ß
                if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                  highlightHalo.bringToFront();   // ‡∏î‡∏∂‡∏á‡∏Ç‡∏≠‡∏ö‡∏Ç‡∏≤‡∏ß‡∏°‡∏≤‡πÑ‡∏ß‡πâ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏∏‡∏î‡∏Å‡πà‡∏≠‡∏ô
                  selectedLayer.bringToFront();   // ‡∏î‡∏∂‡∏á‡πÄ‡∏™‡πâ‡∏ô‡∏™‡∏µ‡πÄ‡∏î‡∏¥‡∏°‡∏°‡∏≤‡∏ó‡∏±‡∏ö‡∏Ç‡∏≠‡∏ö‡∏Ç‡∏≤‡∏ß‡∏≠‡∏µ‡∏Å‡∏ó‡∏µ
                }

                // 4. ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà (Polygon) ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡∏ô‡∏¥‡∏î‡∏ô‡∏∂‡∏á‡πÉ‡∏´‡πâ‡∏î‡∏π‡πÄ‡∏î‡πà‡∏ô
                if (selectedLayer.defaultStyle.fillOpacity > 0) {
                  selectedLayer.setStyle({ fillOpacity: 0.6 });
                }

                // 5. ‡∏ã‡∏π‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏´‡∏≤
                map.flyToBounds(selectedLayer.getBounds(), { padding: [50, 50], duration: 1.5 });
              });
            }
            
            mapLayer.bindPopup(`<div style="font-family:'Prompt'; font-size:14px; text-align:center;"><b>${item.name}</b><br><small>(${item.sheetName})</small></div>`);

            if (!layerGroups[item.sheetName]) {
              layerGroups[item.sheetName] = L.layerGroup().addTo(map);
            }
            layerGroups[item.sheetName].addLayer(mapLayer);

          } catch(e) {
             console.error("‡∏û‡∏¥‡∏Å‡∏±‡∏î‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö: " + item.name);
          }
        });

        L.control.layers(null, layerGroups, { collapsed: false }).addTo(map);
      })
      .catch(err => console.error("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ:", err));

    // --- ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á Admin ---
    let isAdmin = false;
    const drawnItems = new L.FeatureGroup();
    map.addLayer(drawnItems);
    
    const drawControl = new L.Control.Draw({
      edit: { featureGroup: drawnItems },
      draw: {
        polygon: true, polyline: true, marker: true,
        rectangle: false, circle: false, circlemarker: false
      }
    });

    document.getElementById('adminBtn').addEventListener('click', () => {
      if (isAdmin) {
        alert("‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß");
        return;
      }

      const pass = prompt("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà (Admin):");
      
      if (pass === ADMIN_PASSWORD) {
        isAdmin = true;
        map.addControl(drawControl); 
        
        const btn = document.getElementById('adminBtn');
        btn.innerHTML = "üë®‚Äçüíª ‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô (‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç)";
        btn.classList.add('active');
        
        alert("‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");
      } else if (pass !== null) {
        alert("‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!");
      }
    });

    map.on(L.Draw.Event.CREATED, function (event) {
      const layer = event.layer;
      const type = event.layerType; 
      let coordsArray;

      if (type === 'polygon') {
        coordsArray = layer.getLatLngs()[0].map(point => [point.lat, point.lng]);
      } else if (type === 'polyline') {
        coordsArray = layer.getLatLngs().map(point => [point.lat, point.lng]);
      } else if (type === 'marker') {
        coordsArray = [layer.getLatLng().lat, layer.getLatLng().lng];
      }
      
      const coordsString = JSON.stringify(coordsArray);
      let typeTH = type === 'polygon' ? '‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà' : (type === 'polyline' ? '‡πÄ‡∏™‡πâ‡∏ô‡∏ñ‡∏ô‡∏ô' : '‡∏à‡∏∏‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà');
      
      window.prompt(`‡πÄ‡∏û‡∏¥‡πà‡∏° ${typeTH} ‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß!\n‡∏Å‡πä‡∏≠‡∏õ‡∏õ‡∏µ‡πâ‡∏û‡∏¥‡∏Å‡∏±‡∏î‡πÑ‡∏õ‡∏ß‡∏≤‡∏á‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á C ‡∏Ç‡∏≠‡∏á‡∏ä‡∏µ‡∏ï‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£\n(‡πÉ‡∏™‡πà‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á D ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö)`, coordsString);
      drawnItems.addLayer(layer);
    });
  </script>
</body>
</html>




